<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Titre de la page</title>
  <script>
	var id = 0;
	document.addEventListener('DOMContentLoaded', function() {
		var add = document.getElementById("add");
		var symbol = document.getElementById("symbols");
		var proba = document.getElementById("proba");
		var run = document.getElementById("run");
		var result = document.getElementById("result");
		add.addEventListener('click', function() {
			var input = document.createElement("input");
			input.setAttribute("type", "text");
			input.setAttribute("value", "0");
			input.setAttribute("data-id", id);
			symbol.appendChild(input);
			
			var symbols = symbol.getElementsByTagName("input");
			var input = document.createElement("input");
				input.setAttribute("type", "number");
				input.setAttribute("value", 0);
				input.setAttribute("data-id", id);
			
			var div = document.createElement("div");
			div.setAttribute("data-id", id);
			for(var i = 0; i < id + 1; ++i) {
				var input = document.createElement("input");
				input.setAttribute("type", "number");
				input.setAttribute("value", 0);
				input.setAttribute("data-id", i);
				div.appendChild(input);
			}
			proba.appendChild(div);
			
			var divs = proba.getElementsByTagName("div");
			for(var i = 0; i < id; ++i) {
				var input = document.createElement("input");
				input.setAttribute("type", "number");
				input.setAttribute("value", 0);
				input.setAttribute("min", 0);
				input.setAttribute("max", 100);
				input.setAttribute("data-id", id);
				divs[i].appendChild(input);
			}
			
			++id;
			console.log(id);
		});
		
		run.addEventListener('click', function() {
			var it = document.getElementById("it").value;
			var symbols = symbol.getElementsByTagName("input");
			var probas = proba.getElementsByTagName("div");
			var jd = Math.floor(Math.random() * (symbols.length - 0.1));
			var string = "";
			for(var i = 0; i < it; i++) {	
				var val = 0;
				var rand = Math.random() * 100;
				var p = probas[jd];
				var inputs = p.getElementsByTagName("input");
				for(var j = 0; j < inputs.length; j++) {
					val += inputs[j].value;
					if(rand < val) {
						jd = j;
						string = string + symbols[j].value;
						break;
					}
				}
			}
			result.innerHTML = string;
		});
	});
  </script>
</head>
<body>
	<label for="it">Iterations</label>
	<input id="it" type="number" min=0 />
	<form id="symbols">
		<h2>Symbols</h2>
	</form>
	<form id="proba">
		<h2>Proba</h2>
	</form>
	<input id="add" type="button" value="Add" />
	
	<div id="result"></div>
	
	<input id="run" type="button" value="Run"/>
</body>
</html>